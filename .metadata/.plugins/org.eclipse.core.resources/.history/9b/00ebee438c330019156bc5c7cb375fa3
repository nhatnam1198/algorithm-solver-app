import java.util.stream.IntStream;

public class RoundRobin {
	private Process[] processes;
	private int quantum;

	public RoundRobin(Process[] processes, int quantum) {
		super();
		this.processes = processes;
		this.quantum = quantum;
	}
	public RoundRobin() {
		this.processes = null;
		this.quantum = 0;
	}
	
	public void display() {
		tinhThoiGianTrungBinh();
	}
	
	public void tinhThoiGianTrungBinh() {
		System.out.println("Quantum: " + quantum);
		tinhThoiGianChoTrungBinh();
	}
	
	void checkExistElemntArray
	
	public void tinhThoiGianChoTrungBinh() {
		int check = 0;
		int time = 0;
		int[] burstTimeTemp = new int[processes.length];
		int[] arrivalTimeTemp = new int [processes.length];
		int[] waitingTime = new int[processes.length];
		for (int i = 0; i < processes.length; i++) {
			burstTimeTemp[i] = processes[i].getBurstTime();
			arrivalTimeTemp[i] = processes[i].getArrivalTime();
		}
		//Lap cho den khi cac tien trinh da xong het
		while(check <= processes.length) {
			for (int i = 0; i < processes.length; i++) {
				if(processes[i].getArrivalTime() <= time) {
					if(burstTimeTemp[i] > quantum) {
						burstTimeTemp[i] = burstTimeTemp[i] - quantum;
						time = time + quantum;
					}else {  //Neu burstTime nho hon quantum thi tien trinh nay se ket thuc o day, phai lay duoc moc thoi gian tien trinh ket thuc
						check++;
						time = time + burstTimeTemp[i];
						waitingTime[i] = time - processes[i].getBurstTime() - processes[i].getArrivalTime();
						burstTimeTemp[i] = 0;
					}
				}else {
					//Neu tu dau chua co tien trinh nao den thi tang don vi thoi gian len 1 va quet lai tu dau(i--)
					time++;
					i--;
				}
			}
		}
		for (int i = 0; i < processes.length; i++) {
			System.out.println(waitingTime[i]);
		}
		System.out.print(IntStream.of(waitingTime).sum()/ 4f);
	}
}
